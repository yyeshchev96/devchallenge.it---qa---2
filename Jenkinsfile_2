pipeline {
	agent any

	stages {
		stage('Preparation') {
			sh "echo 'test'" 
		}
		stage('API Tests') {
			steps {
				sh '/usr/local/bin/node /usr/local/bin/newman run "devchallenge-r2-tests.json" -e "devchallenge-r2-env.json" --export-environment "devchallenge-r2-env.json" -r cli,htmlextra --reporter-htmlextra-export "reports/APITestSummary.html" --reporter-htmlextra-darkTheme'
			}

		}
		stage("Reporting") {
			publishHTML([
				allowMissing: false, 
				alwaysLinkToLastBuild: false, 
				keepAll: false, 
				reportDir: 'reports', 
				reportFiles: 'APITestSummary.html', 
				reportName: 'Test Summary Report', 
				reportTitles: ''
			])	
		}
	}
}